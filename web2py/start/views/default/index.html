{{extend 'layout.html'}}

{{block head}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script>
    var posts_url = "{{=URL('api', 'get_posts')}}";
    var generate_post_url = "{{=URL('api', 'generate_post')}}";
    var vote_url = "{{=URL('api', 'vote', args=request.args, user_signature=True)}}"
</script>
{{end}}


<div class="main_content">
    <div id="vue-div" class="display:none">
        <a class="SHITPOSTBUTTON" v-on:click="generate_post();">Generate Sentience</a>
        <div class="posts">
            <div v-for="post, index in posts" class="post-content" :key="post.id">
                <div class="post-upvote-box" v-if="post.my_vote==1">
                    <p class="vote-arrow upvote" v-bind:id="'upvote_'+post.id" v-on:click="vote(post.id, index, 1);">▲</p>
                    <p class="vote-count">${post.upvotes}</p>
                    <p class="vote-arrow no-vote" v-bind:id="'downvote_'+post.id" v-on:click="vote(post.id, index, -1);">▼</p>
                </div>
                <div class="post-upvote-box" v-if="post.my_vote==-1">
                    <p class="vote-arrow no-vote" v-bind:id="'upvote_'+post.id" v-on:click="vote(post.id, index, 1);">▲</p>
                    <p class="vote-count">${post.upvotes}</p>
                    <p class="vote-arrow downvoted" v-bind:id="'downvote_'+post.id" v-on:click="vote(post.id, index, -1);">▼</p>
                </div>
                <div class="post-upvote-box" v-if="post.my_vote==0">
                    <p class="vote-arrow no-vote" v-bind:id="'upvote_'+post.id" v-on:click="vote(post.id, index, 1);">▲</p>
                    <p class="vote-count">${post.upvotes}</p>
                    <p class="vote-arrow no-vote" v-bind:id="'downvote_'+post.id" v-on:click="vote(post.id, index, -1);">▼</p>
                </div>
                <a v-bind:href="'{{=URL('post')}}/' + post.id" class="post-contents post-text-box">
                    <p>${post.text_post}</p>
                    <p v-bind:title="post.date_tooltip" class="post-datetime">
                        ${post.date_readable}
                    </p>
                </a>
                <a v-bind:href="'{{=URL('post')}}/' + post.id" class="post-contents">
                    <img v-bind:src="'{{=URL('static', 'images', 'gen')}}/' + post.image" class="post_image" />
                </a>
            </div>
            <p v-if="has_more" class="show_more post-contents"> Loading more content... </p>
        </div>
    </div>
</div>

<script src="{{=URL('static', 'js/default_index.js')}}"></script>
<script src="{{=URL('static', 'js/readable_time.js')}}"></script>
